# 获取当前用户域名列表接口文档

## 接口概述
该接口用于获取当前登录用户的所有3级域名列表，支持按状态过滤。

## 接口详情

### 获取当前用户的域名列表

**接口地址：** `GET /api/user/subdomain/list/mine`

**请求方式：** GET

**Content-Type：** `application/json`

**认证方式：** Bearer Token（JWT）

**请求头：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {token} |

**请求参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| status | String | 否 | 域名状态过滤（ACTIVE-活跃，INACTIVE-不活跃，DELETED-已删除）。不提供则返回所有非删除状态的域名 |

**请求示例：**
```bash
# 获取所有域名
curl -X GET "http://localhost:8080/api/user/subdomain/list/mine" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9..."

# 获取活跃状态的域名
curl -X GET "http://localhost:8080/api/user/subdomain/list/mine?status=ACTIVE" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9..."
```

## 响应格式

### 成功响应
```json
{
  "code": 200,
  "message": "操作成功",
  "data": [
    {
      "id": 1,
      "userId": 123,
      "subdomain": "www",
      "domain": "cblog.eu",
      "fullDomain": "www.cblog.eu",
      "status": "ACTIVE",
      "remark": "user@example.com",
      "createTime": "2025-08-24T03:00:00",
      "updateTime": "2025-08-24T03:00:00"
    },
    {
      "id": 2,
      "userId": 123,
      "subdomain": "blog",
      "domain": "cblog.eu",
      "fullDomain": "blog.cblog.eu",
      "status": "ACTIVE",
      "remark": "user@example.com",
      "createTime": "2025-08-24T03:10:00",
      "updateTime": "2025-08-24T03:10:00"
    }
  ],
  "timestamp": "2025-08-25T00:00:00"
}
```

### 认证失败响应
```json
{
  "code": 401,
  "message": "未授权访问",
  "data": null,
  "timestamp": "2025-08-25T00:00:00"
}
```

### 系统错误响应
```json
{
  "code": 500,
  "message": "获取域名列表失败：数据库连接异常",
  "data": null,
  "timestamp": "2025-08-25T00:00:00"
}
```

## 业务流程

### 查询流程
1. **身份验证**：验证JWT token的有效性
2. **提取用户信息**：从token中获取用户ID
3. **域名查询**：
   - 如果提供了status参数，则按用户ID和状态查询
   - 如果未提供status参数，则查询用户所有非删除状态的域名
4. **返回结果**：返回查询到的域名列表

## 字段说明

### 响应数据字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | Long | 域名记录主键ID |
| userId | Long | 用户ID |
| subdomain | String | 子域名前缀 |
| domain | String | 主域名 |
| fullDomain | String | 完整域名 |
| status | String | 状态（ACTIVE-活跃，INACTIVE-不活跃，DELETED-已删除） |
| remark | String | 备注信息 |
| createTime | LocalDateTime | 创建时间 |
| updateTime | LocalDateTime | 更新时间 |

## 错误处理

### 参数验证错误
- JWT token无效或过期
- Authorization头缺失
- status参数值无效

### 业务逻辑错误
- 用户权限不足
- 数据库操作失败

## 安全考虑

1. **JWT认证**：必须提供有效的JWT token
2. **用户隔离**：只能查询当前登录用户的域名
3. **数据过滤**：默认不返回已删除的域名

## 使用场景

1. **用户域名管理**：用户查看自己注册的所有域名
2. **域名状态筛选**：用户按状态筛选查看域名
3. **域名列表展示**：在用户控制面板中展示域名列表

## 相关接口

- [用户注册3级域名接口](./用户注册3级域名接口.md)
- [查询域名是否已注册接口](./用户域名注册查询接口.md)
- [用户登录接口](../用户登录接口.md)

## 注意事项

1. 接口需要JWT认证，请确保token有效
2. 默认情况下不返回状态为DELETED的域名
3. 域名列表按创建时间降序排列，最新创建的域名排在前面
4. status参数值必须是有效的状态值（ACTIVE、INACTIVE、DELETED）