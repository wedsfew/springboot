# Spring Boot 项目文件映射

## 项目根目录结构

```
/Users/xxh/Aado/springboot/
├── .codebuddy/                    # 代码助手配置目录
│   └── .rules/                    # 规则文件目录
│       ├── api开发规则.mdc        # API开发规则文档
│       ├── my-bakc.mdc           # 备份配置
│       ├── my-code.mdc           # 代码配置
│       ├── 数据表结构.mdc         # 数据库表结构文档
│       └── 项目进度.mdc           # 项目进度跟踪
├── .gitattributes                # Git属性配置文件
├── .gitignore                     # Git忽略文件配置
├── .mvn/                         # Maven包装器目录
│   └── wrapper/
│       └── maven-wrapper.properties  # Maven包装器配置
├── api接口文档/                   # API接口文档目录
│   ├── API接口文档.md            # 主要API接口文档
│   ├── JWT认证过滤器.md           # JWT认证过滤器文档
│   ├── 管理员接口.md              # 管理员接口文档
│   ├── 管理员用户管理接口.md       # 管理员用户管理接口文档
│   ├── 用户登出接口.md            # 用户登出接口文档
│   ├── 用户登录接口.md            # 用户登录接口文档
│   ├── 用户注册接口.md            # 用户注册接口文档
│   ├── 统一响应接口文档.md        # 统一响应格式文档
│   └── 邮箱验证码API接口文档.md    # 邮箱验证码相关API文档
├── api测试/                      # API测试目录
│   ├── UserLoginTest.java        # 用户登录测试类
│   └── UserRegisterTest.java     # 用户注册测试类
├── mvnw                          # Maven包装器脚本（Unix/Linux）
├── mvnw.cmd                      # Maven包装器脚本（Windows）
├── pom.xml                       # Maven项目配置文件
├── 项目文件映射.md                # 项目文件映射文档
└── src/                          # 源代码目录
    ├── main/                     # 主要源代码
    │   ├── java/                 # Java源代码
    │   │   └── com/              # 公司包名
    │   │       └── example/      # 项目包名
    │   │           └── demo/     # 模块名
    │   │               ├── DemoApplication.java  # 应用程序启动类
    │   │               ├── common/               # 通用组件
    │   │               │   ├── ApiResponse.java           # 统一响应实体类
    │   │               │   ├── BusinessException.java     # 业务异常类
    │   │               │   ├── GlobalExceptionHandler.java # 全局异常处理器
    │   │               │   └── ResourceNotFoundException.java # 资源未找到异常
    │   │               ├── config/               # 配置类
    │   │               │   ├── SecurityConfig.java        # 安全配置类
    │   │               │   └── WebSecurityConfig.java     # Web安全配置类
    │   │               ├── controller/           # 控制器层
    │   │               │   ├── AdminController.java       # 管理员控制器
    │   │               │   ├── AdminUserController.java   # 管理员用户管理控制器
    │   │               │   ├── ApiTestController.java     # API测试控制器
    │   │               │   ├── AuthController.java        # 认证控制器
    │   │               │   ├── TestController.java        # 测试控制器
    │   │               │   ├── UserController.java        # 用户管理控制器
    │   │               │   └── VerificationCodeController.java # 验证码控制器
    │   │               ├── dto/                  # 数据传输对象
    │   │               │   ├── AdminLoginRequest.java     # 管理员登录请求DTO
    │   │               │   ├── AdminLoginResponse.java    # 管理员登录响应DTO
    │   │               │   ├── AdminRegisterRequest.java  # 管理员注册请求DTO
    │   │               │   ├── UserCreateRequest.java     # 用户创建请求DTO
    │   │               │   ├── UserLoginRequest.java      # 用户登录请求DTO
    │   │               │   ├── UserLoginResponse.java     # 用户登录响应DTO
    │   │               │   ├── UserRegisterRequest.java   # 用户注册请求DTO
    │   │               │   ├── UserRegisterStep1Request.java # 用户注册第一步请求DTO
    │   │               │   ├── UserRegisterStep2Request.java # 用户注册第二步请求DTO
    │   │               │   ├── UserUpdateRequest.java     # 用户更新请求DTO
    │   │               │   ├── VerificationCodeRequest.java # 验证码请求DTO
    │   │               │   └── VerifyCodeRequest.java      # 验证码验证请求DTO
    │   │               ├── entity/               # 实体类
    │   │               │   ├── Admin.java                 # 管理员实体类
    │   │               │   ├── TokenBlacklist.java        # 令牌黑名单实体类
    │   │               │   ├── User.java                  # 用户实体类
    │   │               │   └── VerificationCode.java      # 验证码实体类
    │   │               ├── filter/               # 过滤器
    │   │               │   └── JwtAuthenticationFilter.java # JWT认证过滤器
    │   │               ├── mapper/               # 数据访问层
    │   │               │   ├── AdminMapper.java           # 管理员数据访问接口
    │   │               │   ├── TokenBlacklistMapper.java  # 令牌黑名单数据访问接口
    │   │               │   └── UserMapper.java            # 用户数据访问接口
    │   │               ├── service/              # 服务层
    │   │               │   ├── AdminService.java          # 管理员服务接口
    │   │               │   ├── TokenBlacklistService.java # 令牌黑名单服务接口
    │   │               │   ├── UserDetailsServiceImpl.java # 用户详情服务实现
    │   │               │   ├── UserService.java           # 用户服务接口
    │   │               │   ├── VerificationCodeService.java # 验证码服务接口
    │   │               │   └── impl/                      # 服务实现
    │   │               │       ├── AdminServiceImpl.java   # 管理员服务实现
    │   │               │       ├── TokenBlacklistServiceImpl.java # 令牌黑名单服务实现
    │   │               │       ├── UserServiceImpl.java    # 用户服务实现
    │   │               │       └── VerificationCodeServiceImpl.java # 验证码服务实现
    │   │               └── util/                 # 工具类
    │   │                   └── JwtUtil.java              # JWT工具类
    │   └── resources/            # 资源文件
    │       ├── application.properties  # 应用配置文件
    │       ├── schema.sql              # 数据库结构脚本
    │       ├── static/                 # 静态资源目录
    │       └── templates/              # 模板文件目录
    └── test/                      # 测试代码
        └── java/
            └── com/
                └── example/
                    └── demo/
                        └── test/
                            ├── AdminLoginTest.java        # 管理员登录测试类
                            ├── AdminUserManagementTest.java # 管理员用户管理测试类
                            ├── UserLoginTest.java         # 用户登录测试类
                            ├── UserLogoutTest.java        # 用户登出测试类
                            └── UserRegisterTest.java      # 用户注册测试类
```

## 功能模块映射

### 1. 用户认证模块
- **控制器**: `AuthController.java`
- **服务**: `UserService.java` / `UserServiceImpl.java`
- **实体**: `User.java`
- **数据访问**: `UserMapper.java`
- **DTO**: `UserLoginRequest.java`, `UserLoginResponse.java`
- **工具**: `JwtUtil.java`
- **测试**: `UserLoginTest.java`
- **文档**: `用户登录接口.md`
- **API接口**:
  - `POST /api/auth/login`: 用户登录
  - `POST /api/auth/logout`: 用户登出
  - `POST /api/auth/register/step1`: 用户注册第一步（发送验证码）
  - `POST /api/auth/register/step2`: 用户注册第二步（验证验证码并完成注册）

### 2. 用户管理模块
- **控制器**: `UserController.java`
- **服务**: `UserService.java` / `UserServiceImpl.java`
- **实体**: `User.java`
- **数据访问**: `UserMapper.java`
- **DTO**: `UserRegisterRequest.java`, `UserRegisterVerifyRequest.java`
- **测试**: `UserRegisterTest.java`
- **文档**: `用户注册接口.md`
- **API接口**:
  - `GET /api/users`: 获取所有用户
  - `GET /api/users/{id}`: 根据ID获取用户
  - `PUT /api/users/{id}`: 更新用户

### 3. 验证码模块
- **控制器**: `VerificationCodeController.java`
- **服务**: `VerificationCodeService.java` / `VerificationCodeServiceImpl.java`
- **实体**: `VerificationCode.java`
- **DTO**: `VerificationCodeRequest.java`, `VerifyCodeRequest.java`
- **文档**: `邮箱验证码API接口文档.md`
- **API接口**:
  - `POST /api/verification/send-code`: 发送验证码
  - `POST /api/verification/verify-code`: 验证验证码

### 4. 管理员模块
- **控制器**: `AdminController.java`
- **服务**: `AdminService.java` / `AdminServiceImpl.java`
- **实体**: `Admin.java`
- **数据访问**: `AdminMapper.java`
- **DTO**: `AdminLoginRequest.java`, `AdminLoginResponse.java`, `AdminRegisterRequest.java`
- **测试**: `AdminLoginTest.java`
- **文档**: `管理员接口.md`
- **API接口**:
  - `POST /api/admin/login`: 管理员登录
  - `POST /api/admin/register`: 管理员注册
  - `GET /api/admin/{id}`: 获取管理员信息
  - `PUT /api/admin/{id}`: 更新管理员信息

### 5. 管理员用户管理模块
- **控制器**: `AdminUserController.java`
- **服务**: `UserService.java` / `UserServiceImpl.java`
- **实体**: `User.java`
- **数据访问**: `UserMapper.java`
- **DTO**: `UserCreateRequest.java`, `UserUpdateRequest.java`
- **测试**: `AdminUserManagementTest.java`
- **文档**: `管理员用户管理接口.md`
- **API接口**:
  - `GET /api/admin/users/{id}`: 根据ID获取用户
  - `POST /api/admin/users`: 创建用户
  - `PUT /api/admin/users/{id}`: 更新用户
  - `DELETE /api/admin/users/{id}`: 删除用户
  - `GET /api/admin/users/email/{email}`: 根据邮箱查询用户

### 6. 安全配置模块
- **配置类**: `SecurityConfig.java`, `WebSecurityConfig.java`
- **过滤器**: `JwtAuthenticationFilter.java`
- **服务**: `TokenBlacklistService.java` / `TokenBlacklistServiceImpl.java`
- **实体**: `TokenBlacklist.java`
- **数据访问**: `TokenBlacklistMapper.java`
- **工具类**: `JwtUtil.java`
- **文档**: `JWT认证过滤器.md`

### 7. 通用组件模块
- **统一响应**: `ApiResponse.java`
- **异常处理**: `BusinessException.java`, `GlobalExceptionHandler.java`, `ResourceNotFoundException.java`
- **文档**: `统一响应接口文档.md`

### 8. 测试模块
- **API测试**: `ApiTestController.java`
- **功能测试**: `TestController.java`
- **用户登录测试**: `UserLoginTest.java`
- **用户注册测试**: `UserRegisterTest.java`
- **用户登出测试**: `UserLogoutTest.java`
- **管理员登录测试**: `AdminLoginTest.java`
- **管理员用户管理测试**: `AdminUserManagementTest.java`
- **API接口**:
  - `GET /api/test/success`: 成功响应测试
  - `GET /api/test/data`: 带数据的成功响应测试
  - `POST /api/test/create`: 创建资源响应测试
  - `GET /api/test/list`: 列表数据响应测试
  - `GET /api/test/business-error`: 业务异常测试
  - `GET /api/test/not-found/{id}`: 资源未找到异常测试
  - `GET /api/test/server-error`: 服务器错误测试

### 9. DNSPod模块
- **配置类**: `TencentCloudConfig.java`
- **服务接口**: `DnspodService.java`
- **服务实现**: `DnspodServiceImpl.java`
- **控制器**: `DnspodController.java`
- **文档**: `DNSPod接口文档.md`
- **API接口**:
  - `GET /api/dnspod/domains`: 获取域名列表
  - `GET /api/dnspod/domains/{domain}/records`: 获取域名记录列表
  - `POST /api/dnspod/domains/{domain}/records`: 创建域名记录
  - `PUT /api/dnspod/domains/{domain}/records/{recordId}`: 修改域名记录
  - `DELETE /api/dnspod/domains/{domain}/records/{recordId}`: 删除域名记录

### 10. 配置和文档模块
- **项目配置**: `pom.xml`, `application.properties`
- **数据库结构**: `schema.sql`
- **API文档**: `api接口文档/` 目录下的所有文档
- **开发规则**: `.codebuddy/.rules/` 目录下的所有文档
- **项目映射**: `项目文件映射.md`

## 文件功能说明

### 核心配置文件
- `pom.xml`: Maven项目依赖管理
- `application.properties`: 应用程序配置（数据库连接、服务器端口等）
- `schema.sql`: 数据库表结构定义

### 应用程序入口
- `DemoApplication.java`: Spring Boot应用程序启动类

### 分层架构说明
1. **Controller层**: 处理HTTP请求，调用Service层
2. **Service层**: 业务逻辑处理，调用Mapper层
3. **Mapper层**: 数据访问，与数据库交互
4. **Entity层**: 数据库表对应的实体类
5. **DTO层**: 数据传输对象，用于接口参数和返回值
6. **Common层**: 通用组件和工具类
7. **Config层**: 配置类，包括安全配置等
8. **Util层**: 工具类，提供通用功能
9. **Filter层**: 过滤器，处理请求和响应

### 新增功能说明
1. **JWT认证**: 实现JwtUtil.java工具类和JwtAuthenticationFilter.java过滤器，支持JWT token生成、验证和黑名单管理
2. **用户认证**: 实现完整的用户注册、登录、登出流程
3. **管理员功能**: 实现管理员注册、登录和用户管理功能
4. **验证码系统**: 实现邮箱验证码发送和验证功能
5. **统一响应格式**: 所有API接口使用统一的响应格式
6. **全局异常处理**: 实现GlobalExceptionHandler统一处理异常
7. **安全配置**: 实现WebSecurityConfig提供细粒度的安全控制

### 文档组织
- API接口按功能模块分类存放
- 开发规则和项目进度在.codebuddy目录下管理
- 数据库结构有专门的文档说明
- 测试用例独立存放在api测试目录
- 项目文件映射提供完整的文件结构说明

## API接口列表

### 用户认证接口
| 接口路径 | 方法 | 描述 | 认证要求 | 状态码 |
|---------|------|------|---------|-------|
| `/api/auth/register/step1` | POST | 用户注册第一步（发送验证码） | 无需认证 | 200/400/409 |
| `/api/auth/register/step2` | POST | 用户注册第二步（验证验证码并完成注册） | 无需认证 | 200/400 |
| `/api/auth/login` | POST | 用户登录 | 无需认证 | 200/401 |
| `/api/auth/logout` | POST | 用户登出 | 需要认证 | 200 |

### 用户管理接口
| 接口路径 | 方法 | 描述 | 认证要求 | 状态码 |
|---------|------|------|---------|-------|
| `/api/users` | GET | 获取所有用户 | 需要认证 | 200 |
| `/api/users/{id}` | GET | 根据ID获取用户 | 需要认证 | 200/404 |
| `/api/users/{id}` | PUT | 更新用户 | 需要认证 | 200/404 |

### 验证码接口
| 接口路径 | 方法 | 描述 | 认证要求 | 状态码 |
|---------|------|------|---------|-------|
| `/api/verification/send-code` | POST | 发送验证码 | 无需认证 | 200 |
| `/api/verification/verify-code` | POST | 验证验证码 | 无需认证 | 200/400 |

### 管理员接口
| 接口路径 | 方法 | 描述 | 认证要求 | 状态码 |
|---------|------|------|---------|-------|
| `/api/admin/register` | POST | 管理员注册 | 无需认证 | 201/400/409 |
| `/api/admin/login` | POST | 管理员登录 | 无需认证 | 200/401 |
| `/api/admin/{id}` | GET | 获取管理员信息 | 需要管理员认证 | 200/404 |
| `/api/admin/{id}` | PUT | 更新管理员信息 | 需要管理员认证 | 200/404 |

### 管理员用户管理接口
| 接口路径 | 方法 | 描述 | 认证要求 | 状态码 |
|---------|------|------|---------|-------|
| `/api/admin/users/{id}` | GET | 根据ID获取用户 | 需要管理员认证 | 200/404 |
| `/api/admin/users` | POST | 创建用户 | 需要管理员认证 | 201/400/409 |
| `/api/admin/users/{id}` | PUT | 更新用户 | 需要管理员认证 | 200/404 |
| `/api/admin/users/{id}` | DELETE | 删除用户 | 需要管理员认证 | 200/404 |
| `/api/admin/users/email/{email}` | GET | 根据邮箱查询用户 | 需要管理员认证 | 200/404 |

### 测试接口
| 接口路径 | 方法 | 描述 | 认证要求 | 状态码 |
|---------|------|------|---------|-------|
| `/health` | GET | 健康检查 | 需要认证 | 200 |
| `/api/test/success` | GET | 成功响应测试 | 需要认证 | 200 |
| `/api/test/data` | GET | 带数据的成功响应测试 | 需要认证 | 200 |
| `/api/test/create` | POST | 创建资源响应测试 | 需要认证 | 201 |
| `/api/test/list` | GET | 列表数据响应测试 | 需要认证 | 200 |
| `/api/test/business-error` | GET | 业务异常测试 | 需要认证 | 400 |
| `/api/test/not-found/{id}` | GET | 资源未找到异常测试 | 需要认证 | 404 |
| `/api/test/server-error` | GET | 服务器错误测试 | 需要认证 | 500 |